<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Import Google Icon Font -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Compiled and minified CSS from Materialize -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <!-- Compiled and minified JavaScript from Materialize -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

    <!-- Link to your custom CSS file -->
    <link rel="stylesheet" type="text/css" href="styles.css">

    <!-- Link to import highlight css format of code boxes -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css" rel="stylesheet" />


    <title>Main Tutorial</title>
</head>

<body class="lime lighten-4">
    <!-- Navigation Bar -->
    <div class="navbar-fixed ">
        <nav class="blue-grey darken-3 lime darken-4">
            <ul class="center-nav-items">
                <li><a href="/public/index.html">Home</a></li>
                <li><a href="/public/main.html">Node Tutorial</a></li>
                <li><a href="#">What is an API?</a></li>
                <li><a href="#">What is NodeJS</a></li>
            </ul>
        </nav>
      </div>

    <!-- Main Tutorial Introduction -->
    <div class="container">
        <div class="card-panel green darken-3 z-depth-2">
            <h4 class="white-text">
                Introduction
                <i class="material-icons right white-text">lightbulb_outline</i>
            </h4>
            <p class="white-text">
                In this tutorial, we will explore how to consume web services through Node.js. This guide is divided into three comprehensive parts, alongside a practical example that integrates all the concepts discussed. The structure of each of the parts
                consists in a concise and brief explanation, followed by an example with our node js application in which we are using 3 apis: OpenAi, Spotify and a news api. 
            </p>
           
        </div>

        <!-- Detailed Tutorial Sections -->
        <!-- Part 1 -->
        <div class="section card-panel light-green lighten-2 hoverable">
            <h3>Part 1: Introduction to Web Services and Node.js</h3>
            <p>This section will introduce web services and their importance in modern web development. We'll also dive into Node.js fundamentals, including its event-driven architecture and non-blocking I/O features.</p>
            <h5><i class="tiny material-icons">chevron_right</i>What is Node.js?</h5>
            <ul>
                  <li><i class="tiny material-icons">check_circle</i>Node.js is a server environment</li>
                  <li><i class="tiny material-icons">check_circle</i>Node.js uses JavaScript outside the browser, in other words it uses JavaScript in the server side</li>
                  <li><i class="tiny material-icons">check_circle</i>Node.js enables us to use JavaScript in both client side and server side</li>
                </ul>
            <h5><i class="tiny material-icons">chevron_right</i>What is an API?</h5>
            <ul>
                <li><i class="tiny material-icons">check_circle</i>API stands for Application Programming Interface.</li>
                <li><i class="tiny material-icons">check_circle</i>It is a set of rules that allows programs to communicate with each other.</li>
                <li><i class="tiny material-icons">check_circle</i>APIs define methods of requesting services from an application or software component.</li>
                <li><i class="tiny material-icons">check_circle</i>They enable integration between different software systems, often over a network.</li>
                <li><i class="tiny material-icons">check_circle</i>APIs can be used to access web-based services, databases, or other resources.</li>
                <li><i class="tiny material-icons">check_circle</i>They provide a layer of security, hiding the details of database or service internals.</li>
                <li><i class="tiny material-icons">check_circle</i>Commonly used in building RESTful web services and applications.</li>
              </ul>
              <img src="img/mesero.png" class="centered-image">
              <p>
                Consider an API as a waiter who manages the orders we (the clients) place, and relays those requests to the chef (the server). Once the chef prepares our meal, the waiter delivers it to us. This allows us to enjoy our meal without needing to understand the intricacies of how it was prepared.
              </p>
              <h5>HTTP methods</h5>
              
             
            
              
              <p>
                <strong>GET Method:</strong> Imagine you're at a restaurant and you ask the waiter for the menu. The waiter (API) brings the menu to you (the client) from the kitchen (the server). This is like a <code>GET</code> request, where you're requesting to see information. In web terms, it's used to retrieve data from a server at the specified resource. 
              </p>
              
              <p>
                <strong>POST Method:</strong> After deciding what you want, you tell the waiter your order. The waiter then conveys your order to the kitchen, where your meal is prepared. This resembles a <code>POST</code> request, where you're sending data (your order) to the server for it to process and store. In web terms, <code>POST</code> is used to submit data to be processed to a specified resource.
              </p>
              <p> We are too lazy to explain the other HTTP methods but our friend Fireship isn't, you will not need other methods for this tutorial
                but its always exciting to learn. 
              </p>
              <iframe width="560" height="315" src="https://www.youtube.com/embed/-MTSQjw5DrM?si=5EZ6ol0pfNDrKEQy" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen class="centered-image"></iframe>
              

        </div>

        <!-- Part 2 -->
        <div class="section card-panel light-green lighten-2" >
            <h3>Part 2: Consuming Web Services Using Node.js</h3>
            <p>In the second part, we'll cover how to use Node.js to make requests to web services. We'll focus on using npm packages like axios or node-fetch to interact with APIs, handle responses, and process JSON data.</p>
            <p>Okay then, by far you should have a notion of what is an api, what is node js and what are http methods, now its time to put this into practice</p>
            <h4>Step by step:</h4>
            <h5><i class="tiny material-icons">beenhere</i>Step 1: Intro </h5>
            <p>In first place we need to consider or think about which API's we want to use depending in what we want to do. In this case we want to do a philosofic reflection about any song and we want to display the news articles about the artist who performed the same song. For this reason we are going to use Spotify API along Open AI API and as third use of API's we are going to use ------------------- .</p>
            <h5><i class="tiny material-icons">beenhere</i>Step 2: Intro </h5>
            <p>Once we have determined our objectives with the APIs and identified which ones we will utilize, we can appropriately commence with the tutorial on consuming web services using Node.js.</p>
            <h5><i class="tiny material-icons">beenhere</i>Step 3: Generating a spotify token.  </h5>
            <p>The first API we will start using is the spotify API. This one because in order to achieve our goals we need to have in first place the spotify token for make querys to spotify and with this get song and artits information for the philosophical reflection.</p>
            <p>So, we can see this request of the token in the following code:</p>
            <div class="card">
              <div class="card-content">
                <span class="card-title">Generating token script</span>
                <pre><code class="language-javascript">
                  async function getSpotifyToken() {
                    const requestOptions = {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                        body: `grant_type=client_credentials&client_id=${client_id}&client_secret=${client_secret}`
                    };
                    const response = await fetch(endpoint_spotify, requestOptions);
                    const data = await response.json();
                    return data.access_token;
                }
                </code></pre>
              </div>
            </div>
            <h5><i class="tiny material-icons">beenhere</i>Step 4: Making our first query to spotify API.</h5>
            <p>Once we obtain the Spotify token, we will execute two queries. The first query will return the name of the song and the artist who performed it and the second one will return only the name of the artist, this because we need this data separate for futures implementations. This data will then be utilized to enable in-depth analysis with OpenAI and for get news about the artist who performed this song.</p>
            <p>The code utilizing the Spotify token to execute the query can be observed in the subsequent code box:</p>
            <div class="card">
              <div class="card-content">
                <span class="card-title">Spotify query script</span>
                <pre><code class="language-javascript">
                  //Async Function for do spotify querys about the song and artist name.
                  async function searchSpotifySong(token, songName) {
                    const requestOptions = {
                        method: 'GET',
                        headers: { 'Authorization': 'Bearer ' + token }
                    };
                    const query = encodeURIComponent(songName);
                    const endpoint = `https://api.spotify.com/v1/search?q=${query}&type=track`;
                    const response = await fetch(endpoint, requestOptions);
                    const data = await response.json();
                    if (data.tracks.items.length > 0) {
                        const artist_name = data.tracks.items[0].artists[0].name
                        const song_name = data.tracks.items[0].name
                        console.log("Song name and artist grabbed from Spotify: ")
                        return `${song_name} by ${artist_name} \n`
                        
                    }
                    throw new Error('Song not found');
                  }

                  //Async Function for do spotify querys about the artist name.
                  async function getArtistName (token, songName) {
                    const requestOptions = {
                        method: 'GET',
                        headers: { 'Authorization': 'Bearer ' + token }
                    };
                    const query = encodeURIComponent(songName);
                    const endpoint = `https://api.spotify.com/v1/search?q=${query}&type=track`;
                    const response = await fetch(endpoint, requestOptions);
                    const data = await response.json();
                    if (data.tracks.items.length > 0) {
                        const artist_name = data.tracks.items[0].artists[0].name
                        return artist_name
                        
                    }
                    throw new Error('Song not found');
                
                }
                </code></pre>
              </div>
            </div>
            
            <h5><i class="tiny material-icons">beenhere</i>Step 5: Making our first Open AI query</h5>
            <p>With the song name and the artist name that we got of the las step, now we can do our first query to Open AI API for achieve the purpose we mentioned before.</p>
            <p>We can see the request of the deep reflection and the request for the news about the song in the following Async functions:</p>
            <div class="card">
              <div class="card-content">
                <span class="card-title">Open AI query script</span>
                <pre><code class="language-javascript">
                  //Async Function for do Open AI querys about deep reflection.
                  async function getOpenAIReflection(song_name_and_artist) {
                    const body = JSON.stringify({
                        model: 'gpt-3.5-turbo',
                        messages: [{ "role": "user", "content": `Give me a deep philosophical reflection about ${song_name_and_artist}.` }]
                    });
                    const requestOptions = {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer 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' },
                        body: body
                    };
                    const response = await fetch(endpoint_ai, requestOptions);
                    const data = await response.json();
                    console.log("Philosophical Reflection generated by gpt-3.5-turbo: ")
                    return data.choices[0].message.content;
                }
                //Async Function for do Open AI querys about news articles of the artist.
                async function fetchNewsArticlesAboutSong(songInfoNews) {
                    const apikey = 'Put here your Open AI key';
                    const encodedSongInfo = encodeURIComponent(songInfoNews); // Ensure the song info is URL-safe
                    const url = `https://gnews.io/api/v4/search?q=${encodedSongInfo}&lang=en&country=us&max=10&apikey=${apikey}`;
                
                    try {
                        const response = await fetch(url);
                        const data = await response.json();
                        const articles = data.articles;
                
                        console.log(`News Related to "${songInfoNews}":`);
                        
                
                        for (let i = 0; i < articles.length; i++) {
                            console.log(`New ${i}: ${articles[i]['title']}`);
                            console.log(`Description: ${articles[i]['description']}`);
                            console.log("\n");
                            // To display all articles, remove the break statement below.
                            break;
                
                        }
                    
                    } catch (error) {
                        console.log('Error fetching news articles:', error);
                    }
                }
                </code></pre>
              </div>
            </div>

            <h5><i class="tiny material-icons">beenhere</i>Step 6: Making an Async function for call the before functions and display the results</h5>
            <p>In this final step, we will execute an asynchronous function that calls all previously mentioned asynchronous functions and establishes a relationship between them. This connection will enable the 'deep reflection' and 'news articles' functions to fulfill their intended purposes. In other words, it will make the generation of deep reflections and news articles about the artist.</p>
            <div class="card">
              <div class="card-content">
                <span class="card-title">Script that makes the magic:</span>
                <pre><code class="language-javascript">
                  (async () => {
                    try {
                        const songToAnalyze = "Poker Face"
                        const token = await getSpotifyToken();
                        const song_info = await searchSpotifySong(token, songToAnalyze);
                        console.log(song_info)
                        const reflection = await getOpenAIReflection(song_info);
                        console.log(reflection);
                        console.log("\n")
                        const artistNameForNews = await getArtistName(token, songToAnalyze)
                        await fetchNewsArticlesAboutSong(artistNameForNews)
                    } catch (error) {
                        console.log('Error:', error.message);
                    }
                  })();
                </code></pre>
              </div>
            </div>

            
        </div>

        <!-- Part 3 -->
        <div class="section card-panel light-green lighten-2 hoverable">
            <h3>Part 3: Advanced Integration and Real-world Application</h3>
            <p>The final part will walk through a practical example that demonstrates how to integrate multiple web services to build a cohesive application. This section aims to solidify your understanding by applying the concepts in a real-world scenario.</p>
        </div>
    </div>

    <!-- Compiled and minified JavaScript at the end of the body for optimized loading -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <!-- LINK TO IMPORT TH JS FILE FOR ENABLE STYLES IN BOX CODE-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-javascript.min.js"></script>
</body>

</html>

